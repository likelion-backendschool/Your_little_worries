<html
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        xmlns:th="http://thymeleaf.org"
        layout:decorate="~{layout}">
<div layout:fragment="content" class="main-content-container container-fluid px-4">
<!--<div>-->
    <h1>결과 페이지</h1>
    <hr>
    <h3 th:text="${article.title}"></h3>
    <h5 th:text="${article.content}"></h5>
    <hr>

<!--    댓글 form-->
    <h2>댓글</h2>

    <form th:action="@{|/comment/create/${article.getId()}|}" th:object="${commentForm}" method="post">
        <div class="alert alert-danger" role="alert" th:if="${#fields.hasAnyErrors()}">
            <div th:each="err : ${#fields.allErrors()}" th:text="${err}" />
        </div>
        <div class="mb-3">
            <label for="content" class="form-label">내용</label>
            <textarea th:field="*{content}" class="form-control" rows="10"></textarea>
        </div>
        <input type="submit" value="저장하기" class="btn btn-primary my-2">
    </form>

<!--    댓글 목록-->
    <table border="1">
        <thead>
        <tr>
            <th>아이디-</th>
            <th>내용-</th>
            <th>생성 시각-</th>
            <th>수정 시각</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="comment : ${commentList}">
            <td th:text="${comment.author.getNickname()}"></td>
            <td th:text="${comment.content}"></td>

            <td th:text="${comment.getCreatedDate()}"></td>
            <td th:text="${comment.getModifiedDate()}"></td>

            <td><a th:href="@{|/comment/modify/${comment.id}|}" class="btn btn-sm btn-outline-secondary" th:text="수정"></a></td>
            <td>
                <a href="javascript:void(0);" th:href="@{|/comment/delete/${comment.id}|}"
               class="delete btn btn-sm btn-outline-secondary" th:text="삭제"></a>
            </td>
        </tr>
        </tbody>
    </table>


<!--    <a th:href="@{|/article/result/${article.id}|}" class="btn btn-sm btn-outline-secondary" th:text="결과페이지"></a>-->
</div>
<script layout:fragment="script" type='text/javascript'>
    const delete_elements = document.getElementsByClassName("delete");
    Array.from(delete_elements).forEach(function (element) {
        element.addEventListener('click', function () {
            if (confirm("정말로 삭제하시겠습니까?")) {
                location.href = this.dataset.uri;
            }
            ;
        });
    });
    const recommend_elements = document.getElementsByClassName("recommend");
    Array.from(recommend_elements).forEach(function (element) {
        element.addEventListener('click', function () {
            if (confirm("정말로 추천하시겠습니까?")) {
                location.href = this.dataset.uri;
            }
            ;
        });
    });
</script>
</html>